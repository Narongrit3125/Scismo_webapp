# ‡∏Ñ‡∏π‡πà‡∏°‡∏∑‡∏≠‡∏Å‡∏≤‡∏£‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡πÇ‡∏Ñ‡πâ‡∏î‡πÉ‡∏´‡πâ‡∏™‡∏≠‡∏î‡∏Ñ‡∏•‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ö Schema ‡πÉ‡∏´‡∏°‡πà

## ‚úÖ ‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÅ‡∏õ‡∏•‡∏á‡∏ó‡∏µ‡πà‡∏ó‡∏≥‡πÅ‡∏•‡πâ‡∏ß

### 1. ‡πÑ‡∏ü‡∏•‡πå Types (`src/types/index.ts`)
- ‚úÖ ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô Role ‡∏à‡∏≤‡∏Å `'ADMIN' | 'EDITOR' | 'MEMBER' | 'STAFF'` ‡πÄ‡∏õ‡πá‡∏ô `'ADMIN' | 'MEMBER' | 'USER'`
- ‚úÖ ‡πÄ‡∏û‡∏¥‡πà‡∏° `password?: string` ‡πÉ‡∏ô User interface
- ‚úÖ ‡πÄ‡∏û‡∏¥‡πà‡∏° `lastLoginAt?: string` ‡πÉ‡∏ô User interface

### 2. ‡∏´‡∏ô‡πâ‡∏≤ Admin Users (`src/app/admin/users/page.tsx`)
- ‚úÖ ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç role filter options
  - ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏à‡∏≤‡∏Å: ADMIN, STAFF, MEMBER
  - ‡πÄ‡∏õ‡πá‡∏ô: ADMIN, MEMBER, USER
- ‚úÖ ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç role display labels
  - ADMIN = "‡∏ú‡∏π‡πâ‡∏î‡∏π‡πÅ‡∏•‡∏£‡∏∞‡∏ö‡∏ö"
  - MEMBER = "‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å‡∏™‡πÇ‡∏°‡∏™‡∏£"
  - USER = "‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ"
- ‚úÖ ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç role select options ‡πÉ‡∏ô‡∏ü‡∏≠‡∏£‡πå‡∏°

---

## üìã ‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÅ‡∏õ‡∏•‡∏á‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏ó‡∏≥‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°

### ‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÅ‡∏•‡∏∞‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç:

#### 1. **API Routes**

##### `src/app/api/users/route.ts`
```typescript
// ‡∏ï‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏±‡∏ö validation ‡πÅ‡∏•‡∏∞ default role
// ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏à‡∏≤‡∏Å: role: Role.MEMBER
// ‡πÄ‡∏õ‡πá‡∏ô: role: Role.USER ‡∏´‡∏£‡∏∑‡∏≠ Role.MEMBER (‡∏ï‡∏≤‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏°)
```

##### `src/app/api/auth/[...nextauth]/route.ts`
```typescript
// ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö session callback ‡πÉ‡∏´‡πâ‡∏™‡πà‡∏á role ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á
// ‡πÅ‡∏•‡∏∞‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö USER, MEMBER, ADMIN ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô
```

#### 2. **Middleware & Authorization**

##### `middleware.ts` (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ)
```typescript
// ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö role-based access control
// ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏à‡∏≤‡∏Å: EDITOR, STAFF
// ‡πÄ‡∏õ‡πá‡∏ô: MEMBER, USER (‡∏ï‡∏≤‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏°)
```

#### 3. **Components**

##### ‡∏´‡∏ô‡πâ‡∏≤‡∏ï‡πà‡∏≤‡∏á‡πÜ ‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡πÅ‡∏™‡∏î‡∏á Role:
- `src/app/profile/page.tsx`
- `src/components/Header.tsx`
- `src/components/UserMenu.tsx` (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ)

‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÅ‡∏•‡∏∞‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Å‡∏≤‡∏£‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏• role label ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î

#### 4. **Database Seed/Migration**

##### `prisma/seed.ts` (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ)
```typescript
// ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç role ‡πÉ‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á
// ‡∏à‡∏≤‡∏Å: EDITOR, STAFF
// ‡πÄ‡∏õ‡πá‡∏ô: MEMBER, USER
```

---

## üîç ‡∏ß‡∏¥‡∏ò‡∏µ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÅ‡∏Å‡πâ

‡∏£‡∏±‡∏ô‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡πÄ‡∏´‡∏•‡πà‡∏≤‡∏ô‡∏µ‡πâ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏´‡∏≤‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏µ‡πà‡∏¢‡∏±‡∏á‡∏°‡∏µ EDITOR ‡∏´‡∏£‡∏∑‡∏≠ STAFF:

```bash
# PowerShell
cd frontend
Get-ChildItem -Recurse -Include *.ts,*.tsx | Select-String -Pattern "EDITOR|STAFF" | Select-Object Path,LineNumber,Line
```

‡∏´‡∏£‡∏∑‡∏≠‡πÉ‡∏ä‡πâ VS Code Search:
1. ‡∏Å‡∏î `Ctrl + Shift + F`
2. ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤: `EDITOR|STAFF`
3. Include: `src/**/*.{ts,tsx}`
4. ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏ó‡∏µ‡∏•‡∏∞‡πÑ‡∏ü‡∏•‡πå

---

## üìù ‡πÅ‡∏ô‡∏ß‡∏ó‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç

### ‡∏Å‡∏é‡∏Å‡∏≤‡∏£‡πÅ‡∏õ‡∏•‡∏á Role:

| Role ‡πÄ‡∏î‡∏¥‡∏° | Role ‡πÉ‡∏´‡∏°‡πà | ‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢ |
|-----------|-----------|----------|
| **ADMIN** | **ADMIN** | ‡∏ú‡∏π‡πâ‡∏î‡∏π‡πÅ‡∏•‡∏£‡∏∞‡∏ö‡∏ö (‡πÑ‡∏°‡πà‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô) |
| **EDITOR** | **MEMBER** | ‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà/‡∏ú‡∏π‡πâ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤ ‚Üí ‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å‡∏™‡πÇ‡∏°‡∏™‡∏£ |
| **STAFF** | **MEMBER** | ‡∏ö‡∏∏‡∏Ñ‡∏•‡∏≤‡∏Å‡∏£ ‚Üí ‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å‡∏™‡πÇ‡∏°‡∏™‡∏£ |
| **MEMBER** | **MEMBER** | ‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å (‡πÑ‡∏°‡πà‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô) |
| *(‡πÉ‡∏´‡∏°‡πà)* | **USER** | ‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ (‡∏ó‡∏µ‡πà‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡πÄ‡∏õ‡πá‡∏ô‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å) |

### ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á (‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥):

```typescript
// ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå
const permissions = {
  ADMIN: {
    canManageUsers: true,
    canManageContent: true,
    canManageActivities: true,
    canViewReports: true,
    canApprove: true
  },
  MEMBER: {
    canManageUsers: false,
    canManageContent: true,      // ‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ç‡πà‡∏≤‡∏ß‡∏™‡∏≤‡∏£/‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°
    canManageActivities: true,
    canViewReports: false,
    canApprove: false
  },
  USER: {
    canManageUsers: false,
    canManageContent: false,     // ‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ‡πÅ‡∏Ñ‡πà‡∏î‡∏π‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô
    canManageActivities: false,
    canViewReports: false,
    canApprove: false
  }
};
```

---

## üóÑÔ∏è ‡∏Å‡∏≤‡∏£ Migrate Database

### ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏Å‡∏≤‡∏£ Migrate:

```bash
cd frontend

# 1. ‡∏™‡∏£‡πâ‡∏≤‡∏á migration script
npx prisma migrate dev --name update_user_roles

# 2. ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï role ‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
# ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÑ‡∏ü‡∏•‡πå SQL: prisma/migrations/[timestamp]_update_existing_roles/migration.sql
```

### SQL Script ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï Role ‡πÄ‡∏î‡∏¥‡∏°:

```sql
-- ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï EDITOR ‡πÅ‡∏•‡∏∞ STAFF ‡πÄ‡∏õ‡πá‡∏ô MEMBER
UPDATE "users" 
SET "role" = 'MEMBER' 
WHERE "role" IN ('EDITOR', 'STAFF');

-- ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå
SELECT "role", COUNT(*) as count 
FROM "users" 
GROUP BY "role";
```

---

## ‚úÖ Checklist ‡∏Å‡∏≤‡∏£‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï

- [x] ‡∏õ‡∏£‡∏±‡∏ö schema.prisma
- [x] ‡∏õ‡∏£‡∏±‡∏ö types/index.ts
- [x] ‡∏õ‡∏£‡∏±‡∏ö admin/users/page.tsx
- [ ] ‡∏õ‡∏£‡∏±‡∏ö API routes (/api/users, /api/auth)
- [ ] ‡∏õ‡∏£‡∏±‡∏ö middleware (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ)
- [ ] ‡∏õ‡∏£‡∏±‡∏ö components ‡∏ó‡∏µ‡πà‡πÅ‡∏™‡∏î‡∏á role
- [ ] ‡∏™‡∏£‡πâ‡∏≤‡∏á migration script
- [ ] ‡∏£‡∏±‡∏ô migration
- [ ] ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏£‡∏∞‡∏ö‡∏ö authentication
- [ ] ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏£‡∏∞‡∏ö‡∏ö authorization
- [ ] ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï documentation

---

## üß™ ‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏™‡∏≠‡∏ö

### ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏´‡∏•‡∏±‡∏á‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç:

1. **‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏™‡∏£‡πâ‡∏≤‡∏á User ‡πÉ‡∏´‡∏°‡πà**
   - ‡∏™‡∏£‡πâ‡∏≤‡∏á USER, MEMBER, ADMIN
   - ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤ role ‡∏ñ‡∏π‡∏Å‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á

2. **‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£ Login**
   - Login ‡∏î‡πâ‡∏ß‡∏¢ user ‡πÅ‡∏ï‡πà‡∏•‡∏∞ role
   - ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á

3. **‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•**
   - ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö role label ‡πÅ‡∏™‡∏î‡∏á‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á
   - ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏™‡∏µ badge ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á

4. **‡∏ó‡∏î‡∏™‡∏≠‡∏ö Authorization**
   - USER ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏Ç‡πâ‡∏≤ /admin
   - MEMBER ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤
   - ADMIN ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏ó‡∏≥‡∏ó‡∏∏‡∏Å‡∏≠‡∏¢‡πà‡∏≤‡∏á

---

## üìû ‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡∏™‡∏≠‡∏ö‡∏ñ‡∏≤‡∏°

‡∏´‡∏≤‡∏Å‡∏û‡∏ö‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏´‡∏£‡∏∑‡∏≠‡∏Ç‡πâ‡∏≠‡∏™‡∏á‡∏™‡∏±‡∏¢:
1. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö error logs
2. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö database schema
3. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Prisma Client generation
4. ‡∏î‡∏π‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£: `SCHEMA_CHANGES.md`

---

**‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î:** 18 ‡∏ï‡∏∏‡∏•‡∏≤‡∏Ñ‡∏° 2568  
**‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞:** ‚ö†Ô∏è ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£ (‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πå)
